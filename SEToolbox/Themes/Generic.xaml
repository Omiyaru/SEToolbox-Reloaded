<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:SEToolbox.Controls"
    xmlns:converters="clr-namespace:SEToolbox.Converters"
    xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation">

    <!-- Shared Gradient Brush -->
    <LinearGradientBrush x:Key="BusyIndicatorBrush">
        <GradientStop Offset="0.00" Color="#FF4050FF"/>
        <GradientStop Offset="0.50" Color="#A09090FF"/>
        <GradientStop Offset="1.00" Color="#00C0D0FF"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="OuterRing"
                         MappingMode="Absolute"
                         StartPoint="399.906,240.414"
                         EndPoint="419.903,240.414">
        <LinearGradientBrush.Transform>
            <MatrixTransform Matrix="-1.000,0.000,0.000,-1.000,419.905,245.373" />
        </LinearGradientBrush.Transform>
        <StaticResource ResourceKey="BusyIndicatorBrush"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="InnerRing"
                         MappingMode="Absolute"
                         StartPoint="489.491,230.414"
                         EndPoint="509.491,230.414">
        <LinearGradientBrush.Transform>
            <MatrixTransform Matrix="1.000,0.000,-0.000,-1.000,-489.491,245.373" />
        </LinearGradientBrush.Transform>
        <StaticResource ResourceKey="BusyIndicatorBrush"/>
    </LinearGradientBrush>
    
    <Style TargetType="{x:Type controls:BusyIndicator}">
        <Setter Property="SnapsToDevicePixels" Value="true"/>
        <Setter Property="Background" Value="#30000000"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="VerticalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:BusyIndicator}">
                    <Border Background="{TemplateBinding Background}">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center" Width="100" Height="24">
                            <!-- ProgressBar -->
                     <ProgressBar x:Name="ProgressBar"
                                         Minimum="0"
                                         Maximum="100"
                                         Value="0.5"
                                         IsIndeterminate="False"
                                         Visibility="Collapsed"
                                         IsEnabled="False"
                                         VerticalAlignment="Center"
                                         HorizontalAlignment="Stretch"
                                         Orientation = "Horizontal"
                                         Height="20"
                                         Foreground= "{StaticResource BusyIndicatorBrush}"
                                         Background="Transparent"
                                         BorderBrush= "Black"
                                         BorderThickness="1"/>

                            <!-- Spinner -->
                            <Canvas x:Name="Spinner"
                                    Width="24" Height="24"
                                    RenderTransformOrigin="0.5,0.5"
                                    Visibility="Collapsed"
                                    IsEnabled="False"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Opacity="1">
                                <Canvas.RenderTransform>
                                    <TransformGroup>
                                        <RotateTransform x:Name="SpinnerRotate"
                                                         Angle="0"/>
                                        <ScaleTransform/>
                                        <SkewTransform/>
                                        <TranslateTransform/>
                                    </TransformGroup>
                                </Canvas.RenderTransform>

                   

                              <Path Canvas.Top="1.932" Canvas.Left="1.937" Fill="{StaticResource BusyIndicatorBrush}">
                                <Path.Data>
                                    <PathGeometry>
                                        <PathFigure StartPoint="10,2.918" IsClosed="True">
                                            <ArcSegment Point="2.920,9.917"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Counterclockwise" />
                                            <LineSegment Point="0,9.917" />
                                            <ArcSegment Point="10,0"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Clockwise" />
                                            <ArcSegment Point="10,2.918"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Clockwise" />
                                        </PathFigure>
                                    </PathGeometry>
                                </Path.Data>
                            </Path>

                            <Path Canvas.Top="1.932" Canvas.Left="1.937" Fill="{StaticResource BusyIndicatorBrush}">
                                <Path.Data>
                                    <PathGeometry>
                                        <PathFigure StartPoint="10,17">
                                            <ArcSegment Point="10,2.918"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Clockwise" />
                                            <ArcSegment Point="2.917,10"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Counterclockwise" />
                                            <LineSegment Point="0,10" />
                                            <ArcSegment Point="10,0"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Counterclockwise" />
                                            <ArcSegment Point="10,17"
                                                        Size="8.08,8.08"
                                                        IsLargeArc="True"
                                                        SweepDirection="Counterclockwise" />
                                        </PathFigure>
                                    </PathGeometry>
                                </Path.Data>
                            </Path>
                            </Canvas>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- ProgressBar Mode -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Mode" Value= "{x:Static controls:Indicator.ProgressBar}"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="ProgressBar" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="ProgressBar" Property="IsEnabled" Value="True"/>
                            <Setter TargetName="Spinner" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="Spinner" Property="IsEnabled" Value="False"/>
                        </MultiTrigger>

                        <!-- Spinner Mode -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Mode" Value= "{x:Static controls:Indicator.Spinner}"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Spinner" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="Spinner" Property="IsEnabled" Value="True"/>
                            <Setter TargetName="ProgressBar" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="ProgressBar" Property="IsEnabled" Value="False"/>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="Spinner"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1" Duration="0:0:0"/>
                                    </Storyboard>
                                </BeginStoryboard>

                                <BeginStoryboard x:Name="SpinnerAnimation">
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimationUsingKeyFrames
                                            Storyboard.TargetName="SpinnerRotate"
                                            Storyboard.TargetProperty="Angle">
                                            <SplineDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                                            <SplineDoubleKeyFrame KeyTime="0:0:0.7" Value="180"/>
                                            <SplineDoubleKeyFrame KeyTime="0:0:1.4" Value="360"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="SpinnerAnimation"/>
                                <BeginStoryboard>
                                    <Storyboard FillBehavior="Stop">
                                        <DoubleAnimation Storyboard.TargetName="SpinnerRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         By="360"
                                                         Duration="0:0:0.3"/>
                                        <DoubleAnimation Storyboard.TargetName="Spinner"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0:0:0.3"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
